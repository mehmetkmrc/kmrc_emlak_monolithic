<!DOCTYPE HTML>
<html lang="en">
    <head>
        <!--=============== basic  ===============-->
        <meta charset="UTF-8">
        <meta http-equiv="x-ua-compatible" content="ie=edge">
        <title>{{.Title}}</title>
        <!--=============== css  ===============-->	
        <link type="text/css" rel="stylesheet" href="/css/modal.css">
        <link type="text/css" rel="stylesheet" href="/css/plugins.css?v=1.0.4">
        <link type="text/css" rel="stylesheet" href="/css/style.css">
        <link type="text/css" rel="stylesheet" href="/css/custom.css">
        <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
        <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
        <link rel="stylesheet" href="/css/disabled.css">
        <link rel="stylesheet" href="/css/db-style.css">
        <!--=============== favicons ===============-->
        <link rel="shortcut icon" href="/images/kmrc-logo.png">
        
    </head>
    <body>
        {{embed}}

    <!-- Modal -->
    <div class="modal fade" id="kt_modal_1" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h3 class="modal-title"></h3>
    
                    <!--begin::Close-->
                    <div class="btn btn-icon btn-sm btn-active-light-primary ms-2" data-bs-dismiss="modal"
                        aria-label="Close">
                        <i class="ki-duotone ki-cross fs-1"><span class="path1"></span><span class="path2"></span></i>
                    </div>
                    <!--end::Close-->
                </div>
    
                <div class="modal-body">
    
                </div>
    
                <div class="modal-footer">
                    <button type="button" class="btn btn-light" data-bs-dismiss="modal"></button>
                </div>
            </div>
        </div>
    </div>
    <div id="imageModal" style="
            display:none;
            position:fixed;
            top:0;
            left:0;
            width:100%;
            height:100%;
            background:rgba(0,0,0,0.95);
            justify-content:center;
            align-items:center;
            z-index:9999;
            overflow:hidden;
            touch-action:none;
         ">
    
        <span onclick="closeImageModal()" style="
                position:absolute;
                top:20px;
                right:30px;
                font-size:28px;
                color:white;
                cursor:pointer;
                z-index:10000;
              ">
            ✖
        </span>
    
        <img id="modalImage" style="
                max-width:90%;
                max-height:90%;
                transform:scale(1);
                transition:transform 0.15s ease;
                cursor:grab;
                user-select:none;
             ">
    </div>

    <script>
        let globalNearbyArray = []; // Nearby verilerini tutacak
        
      

        let scale = 1;
        let lastScale = 1;
        let startDistance = 0;

        function openImageModal(src) {
            scale = 1;
            lastScale = 1;

            const modal = document.getElementById("imageModal");
            const img = document.getElementById("modalImage");

            img.style.transform = "scale(1)";
            img.src = src;
            modal.style.display = "flex";
        }

        function closeImageModal() {
            document.getElementById("imageModal").style.display = "none";
        }


        // ✅ PC SCROLL ZOOM
        document.getElementById("imageModal").addEventListener("wheel", function(e) {
            e.preventDefault();

            if (e.deltaY < 0) scale += 0.1;
            else scale -= 0.1;

            scale = Math.min(Math.max(1, scale), 5);
            document.getElementById("modalImage").style.transform = `scale(${scale})`;
        });


        // ✅ MOBİL PINCH ZOOM
        document.getElementById("imageModal").addEventListener("touchstart", function(e) {
            if (e.touches.length === 2) {
                startDistance = getDistance(e.touches[0], e.touches[1]);
                lastScale = scale;
            }
        });

        document.getElementById("imageModal").addEventListener("touchmove", function(e) {
            if (e.touches.length === 2) {
                e.preventDefault();
                const newDistance = getDistance(e.touches[0], e.touches[1]);
                scale = lastScale * (newDistance / startDistance);
                scale = Math.min(Math.max(1, scale), 5);
                document.getElementById("modalImage").style.transform = `scale(${scale})`;
            }
        });

        function getDistance(t1, t2) {
            return Math.hypot(t2.pageX - t1.pageX, t2.pageY - t1.pageY);
        }


        // ✅ ESC İLE KAPAT
        document.addEventListener("keydown", function(e) {
            if(e.key === "Escape") closeImageModal();
        });
        </script>
        <script>
        function removeImage(el) {
            if(confirm("Bu resmi silmek istiyor musunuz?")) {
                el.parentElement.remove();
            }
        }
</script>    


        <!--=============== scripts  ===============-->   
        <!-- Bootstrap JS dosyası -->
         <script src="/js/jquery.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
        
        <script src="/js/site.js"></script>
        <script src="/js/login.js"></script>
        <script src="/js/register.js"></script>
        
        
        <script src="/js/plugins.js"></script>
        <script src="/js/scripts.js"></script>
        <script src="/js/custom.js"></script>
        <script src="/js/db-scripts.js"></script>
        <script src="/js/profile.js"></script>

        

    </body>
</html>